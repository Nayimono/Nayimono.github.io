<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>대한민국 개인정보 유출 데이터보드 – 데모</title>
  <style>
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',Arial,sans-serif;color:#222;background:#fafafa;margin:0}
    header{padding:18px 16px;background:#fff;border-bottom:1px solid #eee;position:sticky;top:0;z-index:10}
    h1{margin:0;font-size:20px}
    .container{max-width:1200px;margin:0 auto;padding:16px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
    .kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:16px}
    .card{background:#fff;border:1px solid #eee;border-radius:10px;padding:14px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
    .card h3{margin:0 0 8px;font-size:16px}
    .chart{width:100%;height:300px}
    .kpi .chart{height:180px}
    .big{font-size:34px;font-weight:800}
    .sub{color:#777;font-size:12px;margin-top:6px}
    @media (max-width:1024px){.kpi-grid{grid-template-columns:repeat(2,1fr)}.grid{grid-template-columns:1fr}}
    footer{padding:16px;color:#777;font-size:12px}
    .badge{display:inline-block;background:#ff6;color:#333;padding:2px 6px;border-radius:4px;margin-left:8px}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
</head>
<body>
  <header>
    <h1>대한민국 개인정보 유출 데이터보드 <span class="badge">데모</span></h1>
  </header>
  <main class="container">
    <section class="kpi-grid">
      <div class="card kpi">
        <h3>MAX 위험점수</h3>
        <div id="gaugeRisk" class="chart"></div>
        <div class="sub"><span id="topCase">-</span></div>
      </div>
      <div class="card kpi">
        <h3>전체 사건</h3>
        <div class="big" id="totalIncidents">0</div>
        <div class="sub">(기간: <span id="period">-</span>)</div>
      </div>
      <div class="card kpi">
        <h3>노출 레코드 합계</h3>
        <div class="big" id="totalRecords">0</div>
        <div class="sub">평균/사건: <span id="avgRecords">0</span></div>
      </div>
      <div class="card kpi">
        <h3>상위 유출 원인</h3>
        <div class="big" id="topMethod">-</div>
        <div class="sub">(점유율: <span id="topMethodPct">-</span>)</div>
      </div>
    </section>

    <section class="grid">
      <div class="card"><h3>유형별 비율</h3><div id="byMethod" class="chart"></div></div>
      <div class="card"><h3>월별 추이</h3><div id="trend" class="chart"></div></div>
      <div class="card"><h3>사건 분포(버블)</h3><div id="scatter" class="chart"></div></div>
      <div class="card"><h3>부문별 TOP 10</h3><div id="topSector" class="chart"></div></div>
    </section>

    <section class="card">
      <h3>대한민국 2024 개인정보 유출 신고 요약</h3>
      <div id="krSummary"></div>
      <small>출처: 개인정보보호위원회·KISA 「2024년 개인정보 유출 신고 동향 및 예방 방법」(2025‑03‑20)</small>
    </section>
  </main>

  <footer class="container">이 보드는 보안 인식 제고 및 방어 목적으로 제작된 데모 화면입니다.</footer>

  <script>
    // --- 샘플 데이터 (대한민국 사례만) ---
    const DATA = [
      {date:'2025-04-18', organization:'SK Telecom', country:'KR', sector:'Telecom', method:'Malware/Server intrusion', records:0, sensitivity:3, days_to_discovery:2, source:'https://www.msit.go.kr/eng/bbs/view.do?sCode=eng&mPid=2&mId=4&bbsSeqNo=42&nttSeqNo=1139'},
      {date:'2024-11-05', organization:'LocknLock', country:'KR', sector:'Retail', method:'Server hacking', records:0, sensitivity:2, days_to_discovery:7, source:'https://www.fis.kr/ko/major_biz/cyber_safety_oper/attack_info/notice_issue?articleSeq=4219'},
      {date:'2024-07-10', organization:'City Univ. (KR)', country:'KR', sector:'Education', method:'Posting/Mis-send (human error)', records:1200, sensitivity:2, days_to_discovery:1, source:'https://example.org'},
      {date:'2024-03-20', organization:'SME Webshop', country:'KR', sector:'Retail', method:'SQL injection', records:88000, sensitivity:2, days_to_discovery:30, source:'https://example.org'},
      {date:'2024-02-14', organization:'Local Gov.', country:'KR', sector:'Public', method:'System error (API/Code deploy)', records:5400, sensitivity:2, days_to_discovery:0, source:'https://example.org'}
    ];

    const KR_2024_SUMMARY = { total:307, cause:{hacking:56, error:30, system:7}, publicShare:34 };

    const toNum = (v,d=0)=>{ const n=parseFloat(v); return isNaN(n)?d:n; };
    const monthKey = d=>{ const dt=new Date(d); return dt.getFullYear()+ '-' + String(dt.getMonth()+1).padStart(2,'0'); };
    const median = a=>{ if(!a.length) return 0; const s=[...a].sort((x,y)=>x-y); const m=Math.floor(s.length/2); return s.length%2?s[m]:(s[m-1]+s[m])/2; };
    const fmt = n=> Number(n||0).toLocaleString('ko-KR');
    const risk = (rec,sens,method)=>{ const w={ 'Malware/Server intrusion':1.3, 'Server hacking':1.2, 'SQL injection':1.1, 'Credential stuffing':1.1, 'Posting/Mis-send (human error)':0.8, 'System error (API/Code deploy)':0.9 }[method]||1.0; const base=Math.log10(1+Math.max(1,rec)); return Math.min(100, Math.round(base*20*Math.max(1,sens)*w)); };

    // Only KR
    const rows = DATA.filter(r=> (r.country||'').toUpperCase()==='KR').map(r=>({
      ...r,
      records: toNum(r.records,0),
      sensitivity: toNum(r.sensitivity,1),
      days_to_discovery: toNum(r.days_to_discovery,0)
    }));

    // KPIs
    const totalIncidents = rows.length;
    const totalRecords = rows.reduce((a,b)=>a+b.records,0);
    const avgRecords = totalIncidents? Math.round(totalRecords/totalIncidents):0;
    const dates = rows.map(r=>new Date(r.date)).filter(d=>!isNaN(d));
    const minD = dates.length? new Date(Math.min(...dates)):null;
    const maxD = dates.length? new Date(Math.max(...dates)):null;
    document.getElementById('period').textContent = (minD&&maxD)? `${minD.toISOString().slice(0,10)} ~ ${maxD.toISOString().slice(0,10)}`:'-';
    document.getElementById('totalIncidents').textContent = fmt(totalIncidents);
    document.getElementById('totalRecords').textContent = fmt(totalRecords);
    document.getElementById('avgRecords').textContent = fmt(avgRecords);

    // Method share
    const byMethod = {}; rows.forEach(r=> byMethod[r.method]=(byMethod[r.method]||0)+1);
    const mKeys = Object.keys(byMethod); const mVals = mKeys.map(k=>byMethod[k]);
    const topIdx = mVals.length? mVals.indexOf(Math.max(...mVals)):-1;
    if(topIdx>=0){
      document.getElementById('topMethod').textContent = mKeys[topIdx];
      document.getElementById('topMethodPct').textContent = (mVals[topIdx]/totalIncidents*100).toFixed(1)+'%';
    }

    // Top risk gauge
    let top={risk:0,row:null}; rows.forEach(r=>{ const v=risk(r.records,r.sensitivity,r.method); if(v>top.risk) top={risk:v,row:r}; });
    document.getElementById('topCase').textContent = top.row? `${top.row.organization} (${fmt(top.row.records)}건)`:'-';
    const gauge = echarts.init(document.getElementById('gaugeRisk'));
    gauge.setOption({ series:[{ type:'gauge', min:0, max:100, progress:{show:true,width:12}, axisLine:{lineStyle:{width:12}}, axisTick:{show:false}, splitLine:{length:10}, axisLabel:{distance:15}, detail:{valueAnimation:true, formatter:'{value}', fontSize:28}, data:[{value:top.risk}] }] });

    // Method chart
    const mChart = echarts.init(document.getElementById('byMethod'));
    mChart.setOption({ tooltip:{}, xAxis:{type:'category', data:mKeys}, yAxis:{type:'value'}, series:[{type:'bar', data:mVals, itemStyle:{color:'#FF6B6B'}}] });

    // Monthly trend
    const monthly={}; rows.forEach(r=>{ const k=monthKey(r.date); (monthly[k] ||= {count:0, records:[]}); monthly[k].count++; monthly[k].records.push(r.records); });
    const months = Object.keys(monthly).sort(); const counts = months.map(m=>monthly[m].count); const medRec = months.map(m=>median(monthly[m].records));
    const tChart = echarts.init(document.getElementById('trend'));
    tChart.setOption({ tooltip:{trigger:'axis'}, xAxis:{type:'category', data:months}, yAxis:[{type:'value', name:'건수'},{type:'value', name:'중위 레코드', position:'right'}], series:[ {name:'건수', type:'bar', data:counts, itemStyle:{color:'#4E79A7'}}, {name:'중위 레코드', type:'line', yAxisIndex:1, data:medRec, smooth:true, itemStyle:{color:'#F28E2B'}} ] });

    // Scatter
    const sChart = echarts.init(document.getElementById('scatter'));
    const sData = rows.map(r=>({name:r.organization, value:[r.days_to_discovery, r.records, r.sensitivity]}));
    sChart.setOption({ tooltip:{ formatter:p=>`${p.name}<br>발견까지: ${p.value[0]}일<br>노출: ${fmt(p.value[1])}건<br>민감도: ${p.value[2]}` }, xAxis:{name:'발견까지 일수'}, yAxis:{name:'노출 레코드'}, series:[{ type:'scatter', symbolSize:v=>Math.max(8, v[2]*10), data:sData, itemStyle:{color:'#59A14F'} }] });

    // Sector top10
    const bySector={}; rows.forEach(r=> bySector[r.sector]=(bySector[r.sector]||0)+r.records );
    const top10 = Object.entries(bySector).sort((a,b)=>b[1]-a[1]).slice(0,10);
    const sec = echarts.init(document.getElementById('topSector'));
    sec.setOption({ grid:{left:100}, xAxis:{type:'value'}, yAxis:{type:'category', data:top10.map(x=>x[0]), inverse:true}, series:[{type:'bar', data:top10.map(x=>x[1]), itemStyle:{color:'#E15759'}}] });

    // KR summary
    const sum = document.getElementById('krSummary');
    sum.innerHTML = `<ul>
      <li>총 신고: <b>${KR_2024_SUMMARY.total.toLocaleString('ko-KR')}건</b></li>
      <li>원인 비중: 해킹 <b>${KR_2024_SUMMARY.cause.hacking}%</b>, 업무 과실 <b>${KR_2024_SUMMARY.cause.error}%</b>, 시스템 오류 <b>${KR_2024_SUMMARY.cause.system}%</b></li>
      <li>공공기관 비중: <b>${KR_2024_SUMMARY.publicShare}%</b></li>
    </ul>`;
  </script>
</body>
</html>